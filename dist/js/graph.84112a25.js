"use strict";(self["webpackChunknoosmilk"]=self["webpackChunknoosmilk"]||[]).push([[786],{7517:function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var r=s(3396);const o={id:"graph",ref:"graph"};function i(e,t,s,i,a,n){return(0,r.wg)(),(0,r.iD)("div",o,"Loading graph...",512)}s(7658);var a={name:"GraphView",data(){return{nodes:[],links:[]}},mounted(){this.$graphInit({domElement:this.$refs.graph}),this.updateUsers()},methods:{update(){if(void 0!=this.graph){let e=this.nodes.map((e=>({...e}))),t=this.links.map((e=>({...e})));this.graph.graphData({nodes:e,links:t}),console.log(this.graph.graphData())}},updateUsers(){for(const[r,o]of Object.entries(this.users)){console.log("[user]",r,o),o.id=o.clientID,o.group="user";var e=this.nodes.findIndex((e=>e.id==o.id));-1===e?this.nodes.push(o):Object.assign(this.nodes[e],o),console.log(o.rooms);for(const[e,r]of Object.entries(o.rooms)){r.id=e,r.name=e,r.group="room";var t=this.nodes.findIndex((e=>e.id==r.id));-1===t?this.nodes.push(r):Object.assign(this.nodes[t],r);let i={source:o.id,target:r.id,group:"visited",label:"visited",color:"blue"};r.id==o.roomId&&(i.group="current",i.label="current",i.color="red",console.log("#link",i));var s=this.links.findIndex((e=>e.source==i.source&&e.target==i.target));-1===s?this.links.push(i):Object.assign(this.links[s],i)}}this.update()}},watch:{nodes(){this.update()},links(){this.update()},graph(){this.update()},users(){this.updateUsers()},usersUpdateDate(){console.log(this.usersUpdateDate),this.updateUsers(),this.$forceUpdate()},currentNode(){console.log(this.currentNode);let e=this.$store.state.actor.user;switch(this.currentNode.group){case"room":e.roomId=this.currentNode.id,this.$store.commit("actor/setUser",e),this.$openRoom();break;case"user":break;default:console.log("i don't know what to do")}}},computed:{graph(){return this.$store.state.network.graph},users:{cache:!1,get(){return this.$store.state.actor.users}},usersUpdateDate(){return this.$store.state.actor.usersUpdated},uploads(){return this.$store.state.web3.uploads},currentNode(){return this.$store.state.network.currentNode}}},n=s(89);const d=(0,n.Z)(a,[["render",i],["__scopeId","data-v-2c4858ec"]]);var h=d}}]);
//# sourceMappingURL=graph.84112a25.js.map